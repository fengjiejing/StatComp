---
title: "Introduction to StatComp"
author: "Feng Jiejing"
date: "2020-12-09"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to StatComp}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Overview

__StatComp__ is a simple R package which using dichotomy to find confidence intervals  and the solution of functions for the 'Statistical Computing' course. Two functions are considered, namely, _


## introdution about functions
CIdichotomy solve the function confidence interval of dichotomy, two confidence intervals are generated by setting two initial values of the left endpoint of the confidence interval. So the point with a smaller confidence interval should be closer to the left end of the minimum confidence interval

SFdichotomy solve the root of the function is to determine two initial values by roughly estimating the range of the root of the function, and find the value of the function at these two initial values. If the product of the value of the midpoint function and the value of the left endpoint function is negative, then the root of the function is between the left endpoint and the midpoint. Assigns the left endpoint to the midpoint.


The source R code is as follows:
```{r}
cfint <- function(lam,alpha){
  a = 0
  #Sets the initial value of the left endpoint of the confidence interval
  if (qgamma(1-lam,alpha) > alpha-1){
    b = alpha-1
  }
  else{
    b = qgamma(1-lam,alpha)
  }
  # Set the initial value of the right endpoint of the confidence interval (take the point with the highest probability density and the smaller point that forms the minimum point of the confidence interval)
  for (i in 1:40) {
    c = (a+b)/2
    # Take the new end point value of the dichotomy as the midpoint of both
    ap = pgamma(a,alpha)
    aint = pgamma(a,alpha)+lam
    bp = pgamma(b,alpha)
    bint = pgamma(b,alpha)+lam
    a_interval = qgamma(aint,alpha)-qgamma(ap,alpha)
    b_interval = qgamma(bint,alpha)-qgamma(bp,alpha)
    if (b_interval>a_interval)
      b = c
    else
      a = c
    # If the confidence interval generated by 'a' is smaller, then the left endpoint of the shortest confidence interval should be closer to 'a', otherwise, it should be closer to 'b'
    # Assign c to the one that is far from the real value at the left end of the confidence interval
  }
  cat('confidence',lam,'confidence interval',qgamma(ap,alpha),',',qgamma(aint,alpha),']')
}

cfint(0.99,4)
```


```{r}
leftx <- function(lam,alpha,prec){
  a=0
  b=alpha-1
  ga=dgamma(a,alpha)-lam
  gb=dgamma(b,alpha)-lam
  while(b-a>prec){
    c=(a+b)/2
    gc=dgamma(c,alpha)-lam
    if (ga*gc < 0){
      b=c
      gb=gc
    }
    else{
      a=c
      ga=gc
    }
  }
  (a+b)/2
}

leftx(0.2,4,0.00001)

rightx <- function(lam,alpha,prec){
  a=20
  b=alpha-1
  ga=dgamma(a,alpha)-lam
  gb=dgamma(b,alpha)-lam
  while(b-a>prec){
    c=(a+b)/2
    gc=dgamma(c,alpha)-lam
    if (ga*gc < 0){
      b=c
      gb=gc
    }
    else{
      a=c
      ga=gc
    }
  }
  (a+b)/2
}

rightx(0.2,4,0.00001)
```
