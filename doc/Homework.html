<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Feng Jiejing" />

<meta name="date" content="2020-12-09" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Feng Jiejing</h4>
<h4 class="date">2020-12-09</h4>



<div id="question-1" class="section level2">
<h2>2020-09-22 Question 1</h2>
<p>The 1st example should contain texts and at least one figure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">plot</span>(<span class="kw">as.factor</span>(mtcars<span class="op">$</span>hp))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">plot</span>(<span class="kw">as.factor</span>(mtcars<span class="op">$</span>hp),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAAP8AOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmtv+QOgCQ2/+2ZgC2/7a2///bkDrb2//b////AAD/tmb/25D//wD//7b//9v////T80meAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFvElEQVR4nO3df3+aVhhAcbol7ba6prQs02ne/9scvxVy4UC8ppF7zl9+FvIQv0EUvWuyF5st+9U/wEdPIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBoHdDpKav77eeNfpyP1yqgIvva3Nh3N7bfGqDTU89SPDzf4If5iK0BOu6+dTf3yTzIPIKgleeg9hDyHDTRcdc8iyVz/Pg6CBMIeiNQ4bPYuil9UcaNxtI+o+93sJuPPC77r2oK6PeqLPu3SqDAFz8s0D7LPn2PN26m+wPKs+zr4a/ny4uOa8ZRdweUly8Q8/rombrUSBuoPm4OXyqgqYvV1IGqK7DTPy8eQRP1Lw8bqmvHYXcH9FI0T1/7bOIcnTzQO48TiKYJBNMEgmkCwTSBYJpAME0gmCYQTNsM0K3ect0M0I3GCUTTBIJpAsE0gWCaQDBNIJh2d0C4iDNxIF7EmTbQgiV4aQMtWMSZNpBHEMWLOBMH4kWcqQO98ziBaNr9Ak0t4hRoYsqSdxTXv+c4BOq+v9vVAqAIb3O+40Ns/e96BNR+f/tfFwHNHYILf4ZrvnnduBSAivJ4rV8KveUclABQtTzouHt8EShcc6lxeipfJgoUqrtYzR+eBQrVX6zmjwIF61jKSzKBgnWX86cngeKPEwjGCQTjBIJxAsE4gWCcQDBOIBiXMtCydxQTBlo0TiAYJxCMEwjGCQTjBIJxAsE4gWBcCkBXLeJMAOi6RZzbB7pyCd72ga5cxLl9II8g6rpFnAkAXbeIMwWgq8YJBOOSAnLxwsopw7dcx8st25q7Emy8aVtLMfj+MNDE1OGAtyzpvMlDbP6uBA+Ad9xUIIEEulOg7mXizBseaQNNLywTqBd6FGi26X9iUqAV4wQSSCCBBBJIIIEEEqidMnpHUaD5cQIJJJBAAgkk0P0BLVyjmCzQ0jWKqQItXmGWKtDiNYqpAnkEUUvXKCYLtHSNYrpAC8cJJBA1v0ZRoFdTRu8ozi48DK8mfL9NfwXQhhMIinyxur0iX6xur8iXGtsr8sXq9vIIgiJfrG6vyBer28vXQZBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEBQbKDmHaPH9gOQibfViiz79H1wY9Thj5+DG/uJ7c476bbo9x+r2ECHL80dOT2VP28R/knz8kuHz9+aD7D3gXt+3PV/I6e+UW0T2u68k36Lbv/Rig3UvZtfA4Q/wj/uqt958fBc3wj8r/j77oO39kbzXnj+GrvfyXmL6J8mxAYqBncj9Gtv/2P3pddA++xrcze7GzPY7bzzFkXER1ddbKD8z8tTTx66Uy1Q+wFAETTsvq8Bqh82k8dGuZPzFsP9Rygy0HFXvZ+fz34A2/66a6B9+N4MgYaH3Kttywn9FsP9x+gmT/P77hQSPt6bk3T/l7gCH5GsANp35+iLLWKeiG4C1Bwj0x+e5eXJ98ff3b0J3PHlD7FmJ6Mtmv3H6TZA1c9bzJ8Kzi91AvdmBDR9km53Mtoi5nN9ZKD22KmeTuDfiSmf5s8bjxsCTT7NX/zFvHaL6ZFvLfqzWHU3ypPk4fPk8VP/pdb6gZWXp5+LD/zPDYEmXyied9Jv0e0/WtEfYuX5pfq1Fs1n1METa3U50Hyh3fhVI6CpS5KLnRQ08q15sQoJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkE/Q9T41RMUHqsswAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">plot</span>(<span class="kw">as.factor</span>(mtcars<span class="op">$</span>hp),mtcars<span class="op">$</span>carb)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">plot</span>(women<span class="op">$</span>height,women<span class="op">$</span>weight)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>fit=<span class="kw">lm</span>(height<span class="op">~</span>weight,<span class="dt">data=</span>women)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>2020-09-22 Question 2</h2>
<p>The 2nd example should contains texts and at least one table.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>knitr<span class="op">::</span><span class="kw">kable</span> (<span class="kw">head</span>(mtcars,<span class="dt">n=</span><span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Duster 360</td>
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Merc 240D</td>
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Merc 280</td>
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<div id="question-3" class="section level2">
<h2>2020-09-22 Question 3</h2>
<p>The 3rd example should contain at least a couple of LaTeX formulas. <span class="math display">\[\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i\]</span></p>
<p><span class="math display">\[\bar{Y}=\frac{1}{n}\sum_{i=1}^nY_i\]</span> <span class="math display">\[l_{xy}=\sum_{i=1}^n({x_i-\overline{x}})({y_i-\overline{y}})=\sum_{i=1}^n{x_iy_i}-\frac{1}{n}\sum_{i=1}^nx_i\sum_{i=1}^nY_i\]</span></p>
<p><span class="math display">\[l_{xx}=\sum_{i=1}^n({x_i-\overline{x}})^2=\sum_{i=1}^n{x_i}^2-\frac{1}{n}(\sum_{i=1}^nx_i)^2\]</span> <span class="math display">\[l_{yy}=\sum_{i=1}^n({y_i-\overline{y}})^2=\sum_{i=1}^n{y_i}^2-\frac{1}{n}(\sum_{i=1}^ny_i)^2\]</span></p>
</div>
<div id="question-1-1" class="section level2">
<h2>2020-09-29 Question 1</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^a , \quad x{\geq}b&gt;0\quad a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
<p>Plugging in a=2 b=2 and that <span class="math inline">\(F(x)=1-(\frac{2}{x})^2 , \quad x{\geq}2\)</span></p>
<p>Therefore the pdf of <span class="math inline">\(F\)</span> is <span class="math inline">\(f(x)=\frac{8}{x^3} , \quad x{\geq}2\)</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">13456</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>n &lt;-<span class="st"> </span><span class="dv">400</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="co"># F(x) =1-(2/x)^2, 2&lt;=x</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb7-6"><a href="#cb7-6"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="kw">max</span>(x), <span class="fl">.01</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-1" class="section level2">
<h2>2020-09-29 Question 2</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),\quad|x|\leq1\]</span> Devroye and GyÖrfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U1, U2, U3 {\sim} Uniform(−1, 1)\)</span>. If <span class="math inline">\(|U3|{\geq}|U2|\)</span>and <span class="math inline">\(|U3|\geq|U1|\)</span>, deliver <span class="math inline">\(U2\)</span>; otherwise deliver<span class="math inline">\(U3\)</span>. Write a function to generate random variates from fe, and construct the histogram density estimate of a large simulated random sample.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>make_simulate_data=<span class="cf">function</span>(n){</span>
<span id="cb8-2"><a href="#cb8-2"></a>rlist=<span class="kw">c</span>()</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb8-4"><a href="#cb8-4"></a>U=<span class="kw">runif</span>(<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="cf">if</span> (<span class="kw">abs</span>(U[<span class="dv">3</span>]) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(U[<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(U[<span class="dv">3</span>]) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(U[<span class="dv">1</span>])){</span>
<span id="cb8-6"><a href="#cb8-6"></a>  x=U[<span class="dv">2</span>]</span>
<span id="cb8-7"><a href="#cb8-7"></a>} <span class="cf">else</span>{</span>
<span id="cb8-8"><a href="#cb8-8"></a>  x=U[<span class="dv">3</span>]</span>
<span id="cb8-9"><a href="#cb8-9"></a>}</span>
<span id="cb8-10"><a href="#cb8-10"></a>rlist=<span class="kw">c</span>(rlist,x)</span>
<span id="cb8-11"><a href="#cb8-11"></a>}</span>
<span id="cb8-12"><a href="#cb8-12"></a>make_simulate_data=rlist</span>
<span id="cb8-13"><a href="#cb8-13"></a>}</span>
<span id="cb8-14"><a href="#cb8-14"></a>x=<span class="kw">make_simulate_data</span>(<span class="dv">10000</span>)<span class="co">#10000个随机数</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="kw">hist</span>(x,<span class="dt">freq=</span>F,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="kw">lines</span>(<span class="kw">density</span>(x),<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-1" class="section level2">
<h2>2020-09-29 Question 3</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density fe (3.10).</p>
<p>Proof.Notice that<span class="math inline">\(U_1,U_2,U_3{\sim}U(-1,1)\)</span>, suppose<span class="math inline">\(X=|U_1|,Y=|U_2|,Z=|U_3|\)</span>, We have that<span class="math inline">\(X,Y,Z{\sim}U(0,1)\)</span></p>
<p>Notice that<span class="math display">\[V=\begin{cases}Y \quad Z{\geq}XandZ{\geq}Y\\Z\quad Z&lt;XorZ&lt;Y\end{cases}\]</span> We have the distribution function of V <span class="math display">\[\begin{aligned}P(V&lt;v)&amp;=P(Y&lt;v,Z{\geq}XandZ{\geq}Y)+P(Z&lt;v,Z&lt;XorZ&lt;Y)\\&amp;=\int_0^v\mathrm{d}y\int_y^1\mathrm{1-x}\mathrm{d}x+\int_0^v\mathrm{d}y\int_0^y\mathrm{1-y}\mathrm{d}x+P(Z&lt;v,Z&lt;XorZ&lt;Y)\\&amp;=\frac{v}{2}-\frac{v^3}{6}+P(Z&lt;v,Z&lt;XorZ&lt;Y)\end{aligned}\]</span> Notice that X and Y are equal in this function<span class="math display">\[\begin{aligned}P(V&lt;v)&amp;=\frac{v}{2}-\frac{v^3}{6}+2\int_v^1\int_x^1\mathrm{v}\mathrm{d}y\mathrm{d}x+2\int_0^v\int_x^v\mathrm{y}\mathrm{d}y\mathrm{d}x+2\int_0^v\int_v^1\mathrm{v}\mathrm{d}y\mathrm{d}x\\&amp;=\frac{v}{2}-\frac{v^3}{6}+2(\frac{1}{2}v-v^2+\frac{1}{2}v^3)+2(v^2-v^3)+\frac{2}{3}v^3\\&amp;=\frac{3}{2}v-\frac{1}{2}v^3\end{aligned}\]</span> Therefore we have<span class="math display">\[F(v)=\frac{3}{2}v-\frac{1}{2}v^3\]</span></p>
<p>Thus the pdf of <span class="math inline">\(F(v)\)</span> is <span class="math inline">\(f(v)=\frac{3}{2}-\frac{3}{2}v^2\quad 0&lt;v&lt;1\)</span></p>
<p>Suppose<span class="math inline">\(Y=|X|\quad f_e(y)=\frac{3}{2}-\frac{3}{2}y^2 \quad 0&lt;y&lt;1\)</span></p>
<p>Now we conclude that the algorithm generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="question-4" class="section level2">
<h2>2020-09-29 Question 4</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^r, \quad y\geq0\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and<span class="math inline">\(β=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
<p>Plugging in r=4 β=2 and that <span class="math inline">\(F(y)=1-(\frac{2}{2+y})^4, \quad y\geq0\)</span></p>
<p>Therefore the pdf of <span class="math inline">\(F\)</span> is <span class="math inline">\(f(y)=\frac{64}{(2+y)^5} , \quad x{\geq}2\)</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">13456</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb9-4"><a href="#cb9-4"></a>y&lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) <span class="dv">-2</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(y)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>))</span>
<span id="cb9-6"><a href="#cb9-6"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,  <span class="kw">max</span>(y), <span class="fl">.01</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw">lines</span>(x, <span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span><span class="dv">5</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-1-2" class="section level2">
<h2>2020-10-13 Question 1</h2>
<p>Compute a Monte Carlo estimat of<span class="math inline">\(\int_0^\frac{\pi}{3}\mathrm{sint}\mathrm{d}t\)</span> and compare your estimate with the exact value of the integral.</p>
<p>Solve.</p>
<p>Notice that <span class="math inline">\(\theta=\int_0^\frac{\pi}{3}\mathrm{sinx}\mathrm{d}x=\frac{\pi}{3}E(sinX)\)</span> Where<span class="math inline">\(X\sim U(0,\frac{\pi}{3})\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e5</span>; x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>(pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.4991059</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">print</span>(<span class="kw">cos</span>(<span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p>The estimate is <span class="math inline">\(\hat{\theta}=0.4991\)</span> and the exact value of the integral is <span class="math inline">\(θ =cos0-cos\frac{\pi}{3}=0.5\)</span>, the two values are relatively close.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>2020-10-13 Question 2</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<p>Solve.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb14-3"><a href="#cb14-3"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb14-5"><a href="#cb14-5"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</span>
<span id="cb14-6"><a href="#cb14-6"></a>  cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</span>
<span id="cb14-8"><a href="#cb14-8"></a>    g &lt;-<span class="st"> </span><span class="kw">exp</span>(u)</span>
<span id="cb14-9"><a href="#cb14-9"></a>    cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g) </span>
<span id="cb14-10"><a href="#cb14-10"></a>  }</span>
<span id="cb14-11"><a href="#cb14-11"></a>  cdf</span>
<span id="cb14-12"><a href="#cb14-12"></a>}</span>
<span id="cb14-13"><a href="#cb14-13"></a>exact_value=<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>;</span>
<span id="cb14-14"><a href="#cb14-14"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>x&lt;-<span class="fl">1.95</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb14-18"><a href="#cb14-18"></a>  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a>  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb14-20"><a href="#cb14-20"></a>}</span>
<span id="cb14-21"><a href="#cb14-21"></a></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="kw">print</span>(<span class="kw">c</span>(exact_value,<span class="kw">mean</span>(MC1),<span class="kw">mean</span>( MC2),<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),(<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1)))</span></code></pre></div>
<pre><code>## [1] 1.718281828 1.717684177 1.718328258 0.015758081 0.002789852 0.968655902</code></pre>
<p>Taken together, we know estimate θ by the antithetic variate approach is 1.7183 and by the simple Monte Carlo method is 1.7177. The reduction in variance is 96.87%.</p>
<p>Then we Compute the percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using antithetic variates from 5.6. Suppose that <span class="math inline">\(X=e^U\quad Y=e^{1-U}\quad U\sim U(0,1)\)</span> then <span class="math display">\[P(X\leq x)=P(e^U\leq x)=P(U\leq lnx)=lnx\]</span> <span class="math display">\[P(Y\leq y)=P(e^{1-U}\leq y)=P(U\leq lny)=lny\]</span> Therefore X and Y have equal density fuction<span class="math display">\[f(x)=\begin{cases}\frac{1}{x}&amp;1&lt;x&lt;e\\0&amp;else\end{cases}\]</span> we can compute <span class="math display">\[E(e^U)=E(e^{1-U})=\int_1^e\mathrm{1}\mathrm{d}x=e-1\]</span> <span class="math display">\[Var(e^U)=Var(e^{1-U})=\int_1^e\mathrm{y}\mathrm{d}x-(\int_1^e\mathrm{1}\mathrm{d}x)^2=2e-\frac{1}{2}e^2-\frac{3}{2}\]</span> Therfore <span class="math display">\[\begin{aligned}Cov(e^U,e^{1-U})&amp;=Ee-(Ee^U)(Ee^{1-U})\\&amp;=e-(e-1)^2\\&amp;=3e-e^2-1\end{aligned}\]</span> <span class="math display">\[\begin{aligned}Var(e^U+e^{1-U})&amp;=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})\\&amp;=4e-e^2-3+6e-2e^2-2\\&amp;=10e-3e^2-5\end{aligned}\]</span> By the simple Monte Carlo method,<span class="math inline">\(\theta\)</span>can be estimated with<span class="math display">\[\hat\theta=\frac{1}{m}\sum_\limits{i=1}^me^{U_i}\]</span> Therfore variance of <span class="math inline">\(\hat\theta\)</span> is<span class="math display">\[Var\hat\theta=\frac{1}{m}\sum_\limits{i=1}^mVar(e^{U_i})=\frac{2e-\frac{1}{2}e^2-\frac{3}{2}}{m}\]</span></p>
<p>By the antithetic variate approach,<span class="math display">\[\hat{\theta&#39;}=\frac{1}{m}\sum_\limits{i=1}^{\frac{m}{2}}(e^{U_i}+e^{1-U_i})\]</span> Therfore variance of <span class="math inline">\(\hat\theta\)</span> is<span class="math display">\[Var\hat\theta&#39;=\frac{1}{m}\sum_\limits{i=1}^{\frac{m}{2}}Var(e^{U_i}+e^{1-U_i})=\frac{10e-3e^2-5}{2m}\]</span></p>
<p>Compute the percent reduction in variance<span class="math display">\[\frac{Var\hat\theta-Var\hat\theta&#39;}{Var\hat\theta}=\frac{\frac{2e-\frac{1}{2}e^2-\frac{3}{2}}{m}-\frac{10e-3e^2-5}{2m}}{\frac{2e-\frac{1}{2}e^2-\frac{3}{2}}{m}}=\frac{2e^2-6e+2}{4e-e^2-3}\approx96.77\%\]</span></p>
<p>Compare the 96.87% with the theoretical value 96.77% from Exercise 5.6, the two values are relatively close.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>2020-10-13 Question 3</h2>
<p>If <span class="math inline">\(\hat{{\theta}_1}\)</span> and <span class="math inline">\(\hat{{\theta}_2}\)</span> are unbiased estimators of <span class="math inline">\({\theta}\)</span>, and <span class="math inline">\(\hat{{\theta}_1}\)</span> and <span class="math inline">\(\hat{{\theta}_2}\)</span> are antithetic, we derived that <span class="math inline">\(c^*=\frac{1}{2}\)</span>is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{{\theta}_c} = c\hat{{\theta}_1}+(1 − c)\hat{{\theta}_2}\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{{\theta}_1}\)</span> and <span class="math inline">\(\hat{{\theta}_2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{{\theta}_c} = c\hat{{\theta}_1}+(1 − c)\hat{{\theta}_2}\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
<p>Solve.</p>
<p>Notice that <span class="math display">\[\begin{aligned}var(\hat{{\theta}_c})&amp;=var(c\hat{{\theta}_1}+(1 − c)\hat{{\theta}_2})
\\&amp;=c^2var(\hat{{\theta}_1})+(1-c)^2var(\hat{{\theta}_2})+2c(1-c)cov(\hat{{\theta}_1},\hat{{\theta}_2})
\\&amp;=[var(\hat{{\theta}_1})+var(\hat{{\theta}_2})-2cov(\hat{{\theta}_1},\hat{{\theta}_2})]c^2+2[cov(\hat{{\theta}_1},\hat{{\theta}_2})-var(\hat{{\theta}_2})]c+var\hat{{\theta}_2})\end{aligned}\]</span> We know that <span class="math inline">\(var(\hat{\theta}_1-\hat{\theta}_2)=var(\hat{{\theta}_1})+var(\hat{{\theta}_2})-2cov(\hat{{\theta}_1},\hat{{\theta}_2})&gt;0\)</span></p>
<p>Therefore find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator is <span class="math display">\[c^*=-\frac{b}{2a}=-\frac{cov(\hat{{\theta}_1},\hat{{\theta}_2})-var(\hat{{\theta}_2})}{var(\hat{{\theta}_1})+var(\hat{{\theta}_2})-2cov(\hat{{\theta}_1},\hat{{\theta}_2})}\]</span></p>
</div>
<div id="question-1-3" class="section level2">
<h2>2020-10-20 Question 1</h2>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞) and are ‘close’ to<span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating<span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span> by importance sampling? Explain.</p>
<p>The candidates for the importance functions are<span class="math display">\[f_1(x)=e^{-x},x&gt;0\]</span> <span class="math display">\[f_2(x)=\frac{x^2}{2}e^{-x},x&gt;0\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>n&lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb16-5"><a href="#cb16-5"></a>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="ot">Inf</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a>}</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>) </span>
<span id="cb16-9"><a href="#cb16-9"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x))</span>
<span id="cb16-10"><a href="#cb16-10"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb16-11"><a href="#cb16-11"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a>x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n,<span class="dt">shape=</span><span class="dv">3</span>,<span class="dt">scale =</span> <span class="dv">1</span>)</span>
<span id="cb16-14"><a href="#cb16-14"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb16-15"><a href="#cb16-15"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb16-16"><a href="#cb16-16"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb16-17"><a href="#cb16-17"></a> <span class="kw">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.3954870 0.3942769
## se        0.5839443 0.4542022</code></pre>
<p>Therefore we find that the theta.hat is about 0.4,se of f2 is smaller,thus f2 produce the smaller variance in estimating<span class="math inline">\(\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\)</span>.</p>
</div>
<div id="question-2-3" class="section level2">
<h2>2020-10-20 Question 2</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>M &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a>N &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb18-6"><a href="#cb18-6"></a>estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a>g=<span class="cf">function</span>(x) {<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb18-9"><a href="#cb18-9"></a>f=<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))}</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb18-12"><a href="#cb18-12"></a>  estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M)))</span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb18-14"><a href="#cb18-14"></a>    u&lt;-<span class="kw">runif</span>(<span class="dv">2000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb18-15"><a href="#cb18-15"></a>    v&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb18-16"><a href="#cb18-16"></a>    T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(v)<span class="op">/</span><span class="kw">f</span>(v))</span>
<span id="cb18-17"><a href="#cb18-17"></a>  }</span>
<span id="cb18-18"><a href="#cb18-18"></a>  estimates[i,<span class="dv">2</span>] =<span class="st"> </span><span class="kw">sum</span>(T2)</span>
<span id="cb18-19"><a href="#cb18-19"></a>  </span>
<span id="cb18-20"><a href="#cb18-20"></a>}</span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="kw">apply</span>(estimates, <span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5248412 0.5248120</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">apply</span>(estimates, <span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## [1] 0.0026704607 0.0001853237</code></pre>
<p>We know that theta.hat is 0.525,and se is more smaller than estimated value in Example 5.10.</p>
</div>
<div id="question-3-3" class="section level2">
<h2>2020-10-20 Question 3</h2>
<p>Suppose that X1,…,Xn are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter µ. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
<p>Noticed that <span class="math display">\[X1,...,Xn \quad i.i.d\sim LN(\mu,\sigma^2)\]</span> Supposed that <span class="math display">\[Y_i=lnX_i,1\leq i\leq n\]</span> Then we know that <span class="math inline">\(Y_i\sim N(\mu,\sigma^2)\)</span></p>
<p>Therefore when the parameters is unknown, a 95% confidence interval for the parameter µ is that<span class="math display">\[(\bar y-\frac{s}{\sqrt n}t_{1-\alpha}(n-1),(\bar y+\frac{s}{\sqrt n}t_{1-\alpha}(n-1))\]</span> Where <span class="math inline">\(s^2=\frac{1}{n-1}\sum_{i=1}^n(Y_i,\bar Y)^2\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>L&lt;-<span class="kw">numeric</span>(<span class="dv">2020</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>U&lt;-<span class="kw">numeric</span>(<span class="dv">2020</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2020</span>){</span>
<span id="cb22-7"><a href="#cb22-7"></a>    x&lt;-<span class="kw">rlnorm</span>(n,<span class="dt">meanlog =</span> <span class="dv">0</span>,<span class="dt">sdlog =</span> <span class="dv">1</span>)</span>
<span id="cb22-8"><a href="#cb22-8"></a>    y =<span class="st"> </span><span class="kw">log</span>(x)</span>
<span id="cb22-9"><a href="#cb22-9"></a>    L[i]&lt;-<span class="kw">mean</span>(y)<span class="op">-</span>((<span class="kw">sqrt</span>(n<span class="op">/</span>(n<span class="dv">-1</span>))<span class="op">*</span><span class="kw">sd</span>(y))<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a>    U[i]&lt;-<span class="kw">mean</span>(y)<span class="op">+</span>((<span class="kw">sqrt</span>(n<span class="op">/</span>(n<span class="dv">-1</span>))<span class="op">*</span><span class="kw">sd</span>(y))<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb22-11"><a href="#cb22-11"></a>}</span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="kw">mean</span>(L<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>U<span class="op">&gt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.9539604</code></pre>
<p>Thus using a Monte Carlo method to obtain an empirical estimate of the confidence level is 0.9539604.</p>
</div>
<div id="question-4-1" class="section level2">
<h2>2020-10-20 Question 4</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>L&lt;-<span class="kw">numeric</span>(<span class="dv">2020</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a>U&lt;-<span class="kw">numeric</span>(<span class="dv">2020</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2020</span>){</span>
<span id="cb24-7"><a href="#cb24-7"></a>  X &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a>  L[i]&lt;-<span class="kw">mean</span>(X)<span class="op">-</span>((<span class="kw">sqrt</span>(n<span class="op">/</span>(n<span class="dv">-1</span>))<span class="op">*</span><span class="kw">sd</span>(X))<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a>  U[i]&lt;-<span class="kw">mean</span>(X)<span class="op">+</span>((<span class="kw">sqrt</span>(n<span class="op">/</span>(n<span class="dv">-1</span>))<span class="op">*</span><span class="kw">sd</span>(X))<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a>}</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="kw">mean</span>(L<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>U<span class="op">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.929703</code></pre>
<p>Compare the t-interval results with the simulation results in Example 6.4,we find that this coverage probability of the t-interval is smaller.</p>
</div>
<div id="question-1-4" class="section level2">
<h2>2020-10-27 Question 1</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">set.seed</span>(<span class="dv">77</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>m &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>beta&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">4</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a>sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb26-7"><a href="#cb26-7"></a>N=<span class="kw">length</span>(beta)</span>
<span id="cb26-8"><a href="#cb26-8"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb26-9"><a href="#cb26-9"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb26-10"><a href="#cb26-10"></a>sk&lt;-<span class="cf">function</span>(x){</span>
<span id="cb26-11"><a href="#cb26-11"></a>  xb&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb26-12"><a href="#cb26-12"></a>  v3&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xb)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb26-13"><a href="#cb26-13"></a>  v2&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xb)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="kw">return</span>(v3<span class="op">/</span>v2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb26-15"><a href="#cb26-15"></a>}</span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb26-18"><a href="#cb26-18"></a>  x=<span class="kw">rbeta</span>(n,beta[i],beta[i])</span>
<span id="cb26-19"><a href="#cb26-19"></a>  sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb26-20"><a href="#cb26-20"></a>}</span>
<span id="cb26-21"><a href="#cb26-21"></a>pwr[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb26-22"><a href="#cb26-22"></a>}</span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="kw">plot</span>(beta, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(beta), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb26-26"><a href="#cb26-26"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="kw">lines</span>(beta, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="kw">lines</span>(beta, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>t&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">4</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a>sktests=<span class="kw">numeric</span>(m)</span>
<span id="cb27-7"><a href="#cb27-7"></a>N=<span class="kw">length</span>(t)</span>
<span id="cb27-8"><a href="#cb27-8"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb27-9"><a href="#cb27-9"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb27-10"><a href="#cb27-10"></a>sk&lt;-<span class="cf">function</span>(x){</span>
<span id="cb27-11"><a href="#cb27-11"></a>  xb&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb27-12"><a href="#cb27-12"></a>  v3&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xb)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb27-13"><a href="#cb27-13"></a>  v2&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xb)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="kw">return</span>(v3<span class="op">/</span>v2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb27-15"><a href="#cb27-15"></a>}</span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb27-17"><a href="#cb27-17"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb27-18"><a href="#cb27-18"></a>  x=<span class="kw">rt</span>(n,t[i])</span>
<span id="cb27-19"><a href="#cb27-19"></a>  sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb27-20"><a href="#cb27-20"></a>}</span>
<span id="cb27-21"><a href="#cb27-21"></a>pwr[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb27-22"><a href="#cb27-22"></a>}</span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="kw">plot</span>(t, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(t), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb27-26"><a href="#cb27-26"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="kw">lines</span>(t, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="kw">lines</span>(t, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-4" class="section level2">
<h2>2020-10-27 Question 2</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat \alpha\)</span>= 0.055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb28-4"><a href="#cb28-4"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb28-5"><a href="#cb28-5"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb28-6"><a href="#cb28-6"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb28-7"><a href="#cb28-7"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb28-9"><a href="#cb28-9"></a>}</span>
<span id="cb28-10"><a href="#cb28-10"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb28-11"><a href="#cb28-11"></a>power=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb28-12"><a href="#cb28-12"></a>m=<span class="dv">2500</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb28-16"><a href="#cb28-16"></a>  power[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb28-17"><a href="#cb28-17"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb28-18"><a href="#cb28-18"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2) </span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="kw">count5test</span>(x, y)</span>
<span id="cb28-20"><a href="#cb28-20"></a>}))</span>
<span id="cb28-21"><a href="#cb28-21"></a>}</span>
<span id="cb28-22"><a href="#cb28-22"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.1148 0.8540 0.9972</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a>power=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>m=<span class="dv">2500</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb30-8"><a href="#cb30-8"></a>  power[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb30-9"><a href="#cb30-9"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb30-10"><a href="#cb30-10"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2) </span>
<span id="cb30-11"><a href="#cb30-11"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>,<span class="st">&#39;less&#39;</span>,<span class="st">&#39;greater&#39;</span>),<span class="dt">conf.level =</span> <span class="fl">0.945</span>)<span class="op">$</span>p.value<span class="op">&lt;</span>alpha))</span>
<span id="cb30-12"><a href="#cb30-12"></a>}))</span>
<span id="cb30-13"><a href="#cb30-13"></a>}</span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.2164 0.9808 1.0000</code></pre>
</div>
<div id="question-4-2" class="section level2">
<h2>2020-10-27 Question 4</h2>
<p>Discussion If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? (1)What is the corresponding hypothesis test problem? (2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? (3)What information is needed to test your hypothesis?</p>
<p>(1)if we make powers for two methods under a particular simulation is p1 and p2,the corresponding hypothesis test problem is <span class="math display">\[H_0 :p_1=p_2 \quad vs \quad H_1:p_1 \not=p_2\]</span> (2)In my opinion,we can use Z-test, paired-t test or McNemar test, in Z-test we can make <span class="math inline">\(Z_i=Y_i-X_i\)</span>,paired-t test and McNemar test are used for the analysis of paired count data, and they can analyze whether the results before and after the experiment are different.However,two-sample t-test requires the samples to be independent. Obviously, the samples in the question are the same set of samples, which cannot be independent of each other,thus we don’t choose it.</p>
<p>(3)I think we need to know Sample mean,Sample var,Sample size etc,if I want to test my hypothesis.</p>
</div>
<div id="question-1-5" class="section level2">
<h2>2020-11-10 Question 1</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>mu1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>m &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>alphahat0&lt;-alphahat1&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb32-10"><a href="#cb32-10"></a></span>
<span id="cb32-11"><a href="#cb32-11"></a>cf &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb32-12"><a href="#cb32-12"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb32-13"><a href="#cb32-13"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-14"><a href="#cb32-14"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb32-15"><a href="#cb32-15"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb32-17"><a href="#cb32-17"></a>}</span>
<span id="cb32-18"><a href="#cb32-18"></a></span>
<span id="cb32-19"><a href="#cb32-19"></a>cfp &lt;-<span class="st"> </span><span class="cf">function</span>(z) {</span>
<span id="cb32-20"><a href="#cb32-20"></a>  x &lt;-<span class="st"> </span>z[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(z)<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb32-21"><a href="#cb32-21"></a>  y &lt;-<span class="st"> </span>z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(z)<span class="op">/</span><span class="dv">2</span>))]</span>
<span id="cb32-22"><a href="#cb32-22"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb32-23"><a href="#cb32-23"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-24"><a href="#cb32-24"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </span>
<span id="cb32-25"><a href="#cb32-25"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb32-26"><a href="#cb32-26"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb32-27"><a href="#cb32-27"></a>}</span>
<span id="cb32-28"><a href="#cb32-28"></a></span>
<span id="cb32-29"><a href="#cb32-29"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb32-30"><a href="#cb32-30"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb32-31"><a href="#cb32-31"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb32-32"><a href="#cb32-32"></a>  x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </span>
<span id="cb32-33"><a href="#cb32-33"></a>  y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-34"><a href="#cb32-34"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb32-35"><a href="#cb32-35"></a>  per &lt;-<span class="st"> </span><span class="cf">function</span>(t,n) {</span>
<span id="cb32-36"><a href="#cb32-36"></a>    op &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb32-37"><a href="#cb32-37"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb32-38"><a href="#cb32-38"></a>      p &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(t),<span class="kw">length</span>(t),replace &lt;-<span class="st"> </span>F)</span>
<span id="cb32-39"><a href="#cb32-39"></a>      op[j] &lt;-<span class="st"> </span><span class="kw">cfp</span>(t[p])</span>
<span id="cb32-40"><a href="#cb32-40"></a>    }</span>
<span id="cb32-41"><a href="#cb32-41"></a>    <span class="kw">sum</span>(op)<span class="op">/</span>n</span>
<span id="cb32-42"><a href="#cb32-42"></a>  }</span>
<span id="cb32-43"><a href="#cb32-43"></a>  alphahat0[i]&lt;-<span class="kw">cf</span>(x,y)</span>
<span id="cb32-44"><a href="#cb32-44"></a>  alphahat1[i]&lt;-<span class="kw">per</span>(z,m)</span>
<span id="cb32-45"><a href="#cb32-45"></a>}</span>
<span id="cb32-46"><a href="#cb32-46"></a>alphahat2&lt;-<span class="kw">mean</span>(alphahat0)</span>
<span id="cb32-47"><a href="#cb32-47"></a>alphahat3&lt;-<span class="kw">mean</span>(alphahat1)</span>
<span id="cb32-48"><a href="#cb32-48"></a><span class="kw">round</span>(<span class="kw">c</span>(cf&lt;-alphahat2,cfp&lt;-alphahat3),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.107000 0.063131</code></pre>
</div>
<div id="question-2-5" class="section level2">
<h2>2020-11-10 Question 2</h2>
<p>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations.</p>
<p>(2)Unequal variances and unequal expectations.</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions).</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls).</p>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<p>(1)Unequal variances and equal expectations.</p>
<p>Solve.Suppose that<span class="math display">\[F\sim N(0,1),G\sim N(0,4)\]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="kw">library</span>(RANN) </span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb34-6"><a href="#cb34-6"></a>mu1&lt;-<span class="dv">0</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>mu2&lt;-<span class="dv">0</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>sigma1&lt;-<span class="dv">1</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>sigma2&lt;-<span class="dv">2</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>mu &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb34-14"><a href="#cb34-14"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb34-15"><a href="#cb34-15"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb34-16"><a href="#cb34-16"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb34-17"><a href="#cb34-17"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; </span>
<span id="cb34-18"><a href="#cb34-18"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; </span>
<span id="cb34-19"><a href="#cb34-19"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb34-20"><a href="#cb34-20"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb34-21"><a href="#cb34-21"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb34-22"><a href="#cb34-22"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb34-23"><a href="#cb34-23"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb34-24"><a href="#cb34-24"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb34-25"><a href="#cb34-25"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb34-26"><a href="#cb34-26"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb34-27"><a href="#cb34-27"></a>}</span>
<span id="cb34-28"><a href="#cb34-28"></a> N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb34-29"><a href="#cb34-29"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb34-30"><a href="#cb34-30"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb34-31"><a href="#cb34-31"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb34-32"><a href="#cb34-32"></a>  tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb34-33"><a href="#cb34-33"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</span>
<span id="cb34-34"><a href="#cb34-34"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>tb[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb34-35"><a href="#cb34-35"></a>}</span>
<span id="cb34-36"><a href="#cb34-36"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb34-37"><a href="#cb34-37"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb34-38"><a href="#cb34-38"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p);</span>
<span id="cb34-39"><a href="#cb34-39"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p);</span>
<span id="cb34-40"><a href="#cb34-40"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb34-41"><a href="#cb34-41"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb34-42"><a href="#cb34-42"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb34-43"><a href="#cb34-43"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb34-44"><a href="#cb34-44"></a>}</span>
<span id="cb34-45"><a href="#cb34-45"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb34-46"><a href="#cb34-46"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb34-47"><a href="#cb34-47"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.668 0.752 0.985</code></pre>
<p>From above we know that power of nn = 0.668 ,power of energy = 0.752 and power of ball = 0.985.</p>
<p>(2)Unequal variances and unequal expectations.</p>
<p>Solve.Suppose that<span class="math display">\[F\sim N(0,1),G\sim N(1,4)\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">library</span>(RANN) </span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb36-6"><a href="#cb36-6"></a>mu1&lt;-<span class="dv">0</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>mu2&lt;-<span class="dv">1</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>sigma1&lt;-<span class="dv">1</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>sigma2&lt;-<span class="dv">2</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>mu &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb36-14"><a href="#cb36-14"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb36-15"><a href="#cb36-15"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb36-16"><a href="#cb36-16"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb36-17"><a href="#cb36-17"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; </span>
<span id="cb36-18"><a href="#cb36-18"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; </span>
<span id="cb36-19"><a href="#cb36-19"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb36-20"><a href="#cb36-20"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb36-21"><a href="#cb36-21"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb36-22"><a href="#cb36-22"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb36-23"><a href="#cb36-23"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb36-24"><a href="#cb36-24"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb36-25"><a href="#cb36-25"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb36-26"><a href="#cb36-26"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb36-27"><a href="#cb36-27"></a>}</span>
<span id="cb36-28"><a href="#cb36-28"></a> N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb36-29"><a href="#cb36-29"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb36-30"><a href="#cb36-30"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb36-31"><a href="#cb36-31"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb36-32"><a href="#cb36-32"></a>  tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb36-33"><a href="#cb36-33"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</span>
<span id="cb36-34"><a href="#cb36-34"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>tb[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb36-35"><a href="#cb36-35"></a>}</span>
<span id="cb36-36"><a href="#cb36-36"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb36-37"><a href="#cb36-37"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb36-38"><a href="#cb36-38"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p);</span>
<span id="cb36-39"><a href="#cb36-39"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p);</span>
<span id="cb36-40"><a href="#cb36-40"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb36-41"><a href="#cb36-41"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb36-42"><a href="#cb36-42"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb36-43"><a href="#cb36-43"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb36-44"><a href="#cb36-44"></a>}</span>
<span id="cb36-45"><a href="#cb36-45"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb36-46"><a href="#cb36-46"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb36-47"><a href="#cb36-47"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.913 0.992 0.997</code></pre>
<p>From above we know that power of nn = 0.913 ,power of energy = 0.992 and power of ball = 0.997.</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions).</p>
<p>Solve.Suppose that bimodel distribution is <span class="math display">\[0.5(0,1)+0.5N(0,4)\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">library</span>(RANN) </span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb38-6"><a href="#cb38-6"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>mu &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb38-12"><a href="#cb38-12"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb38-13"><a href="#cb38-13"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; </span>
<span id="cb38-14"><a href="#cb38-14"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; </span>
<span id="cb38-15"><a href="#cb38-15"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb38-16"><a href="#cb38-16"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb38-17"><a href="#cb38-17"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb38-18"><a href="#cb38-18"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb38-19"><a href="#cb38-19"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-20"><a href="#cb38-20"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-21"><a href="#cb38-21"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb38-22"><a href="#cb38-22"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb38-23"><a href="#cb38-23"></a>}</span>
<span id="cb38-24"><a href="#cb38-24"></a> N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb38-25"><a href="#cb38-25"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb38-26"><a href="#cb38-26"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb38-27"><a href="#cb38-27"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb38-28"><a href="#cb38-28"></a>  tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb38-29"><a href="#cb38-29"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</span>
<span id="cb38-30"><a href="#cb38-30"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>tb[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb38-31"><a href="#cb38-31"></a>}</span>
<span id="cb38-32"><a href="#cb38-32"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb38-33"><a href="#cb38-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb38-34"><a href="#cb38-34"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb38-35"><a href="#cb38-35"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb38-36"><a href="#cb38-36"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb38-37"><a href="#cb38-37"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb38-38"><a href="#cb38-38"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb38-39"><a href="#cb38-39"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb38-40"><a href="#cb38-40"></a>}</span>
<span id="cb38-41"><a href="#cb38-41"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb38-42"><a href="#cb38-42"></a>pow0&lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb38-43"><a href="#cb38-43"></a>pow0</span></code></pre></div>
<pre><code>## [1] 0.050 0.060 0.054</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb40-2"><a href="#cb40-2"></a>  sigma=<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">size =</span> n1<span class="op">*</span>p,</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb40-4"><a href="#cb40-4"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, sigma),<span class="dt">ncol=</span>p);</span>
<span id="cb40-5"><a href="#cb40-5"></a>sigma=<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">size =</span> n1<span class="op">*</span>p,</span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb40-7"><a href="#cb40-7"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, sigma),<span class="dt">ncol=</span>p);</span>
<span id="cb40-8"><a href="#cb40-8"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb40-9"><a href="#cb40-9"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb40-10"><a href="#cb40-10"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb40-11"><a href="#cb40-11"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb40-12"><a href="#cb40-12"></a>}</span>
<span id="cb40-13"><a href="#cb40-13"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb40-14"><a href="#cb40-14"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb40-15"><a href="#cb40-15"></a>pow1</span></code></pre></div>
<pre><code>## [1] 0.040 0.046 0.048</code></pre>
<p>From above we know that power of nn = 0.050 ,power of energy = 0.060, power of ball = 0.054 under t distribution with 1 df,and power of nn = 0.040 ,power of energy = 0.046, power of ball = 0.048 under bimodel distribution <span class="math inline">\(0.5(0,1)+0.5N(0,4)\)</span>.</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls).</p>
<p>Solve.Suppose that <span class="math display">\[X=\{X_1,...X_{10}\}\quad Y=\{Y_1,...,Y_{100}\}\quad X,Y\sim N(0,1)\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">library</span>(RANN) </span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb42-6"><a href="#cb42-6"></a>mu1&lt;-<span class="dv">0</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>mu2&lt;-<span class="dv">0</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>sigma1&lt;-<span class="dv">1</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>sigma2&lt;-<span class="dv">1</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb42-11"><a href="#cb42-11"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb42-12"><a href="#cb42-12"></a>p&lt;-<span class="dv">2</span></span>
<span id="cb42-13"><a href="#cb42-13"></a>mu &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb42-14"><a href="#cb42-14"></a>n1 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb42-15"><a href="#cb42-15"></a>n2 &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb42-16"><a href="#cb42-16"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb42-18"><a href="#cb42-18"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; </span>
<span id="cb42-19"><a href="#cb42-19"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; </span>
<span id="cb42-20"><a href="#cb42-20"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb42-21"><a href="#cb42-21"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb42-22"><a href="#cb42-22"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb42-23"><a href="#cb42-23"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb42-24"><a href="#cb42-24"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb42-25"><a href="#cb42-25"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb42-26"><a href="#cb42-26"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb42-27"><a href="#cb42-27"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb42-28"><a href="#cb42-28"></a>}</span>
<span id="cb42-29"><a href="#cb42-29"></a>  N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb42-30"><a href="#cb42-30"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb42-31"><a href="#cb42-31"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb42-32"><a href="#cb42-32"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb42-33"><a href="#cb42-33"></a>  tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb42-34"><a href="#cb42-34"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</span>
<span id="cb42-35"><a href="#cb42-35"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>tb[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb42-36"><a href="#cb42-36"></a>}</span>
<span id="cb42-37"><a href="#cb42-37"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb42-38"><a href="#cb42-38"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb42-39"><a href="#cb42-39"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p);</span>
<span id="cb42-40"><a href="#cb42-40"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p);</span>
<span id="cb42-41"><a href="#cb42-41"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb42-42"><a href="#cb42-42"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb42-43"><a href="#cb42-43"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb42-44"><a href="#cb42-44"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb42-45"><a href="#cb42-45"></a>}</span>
<span id="cb42-46"><a href="#cb42-46"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb42-47"><a href="#cb42-47"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb42-48"><a href="#cb42-48"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.054 0.042 0.043</code></pre>
<p>From above we know that power of nn = 0.054 ,power of energy = 0.042, power of ball = 0.043.</p>
</div>
<div id="question-1-6" class="section level2">
<h2>2020-11-17 Question 1</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="cf">if</span> (<span class="kw">any</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)) </span>
<span id="cb44-4"><a href="#cb44-4"></a>    <span class="kw">return</span> (<span class="kw">exp</span>(x)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="cf">else</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>    <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb44-7"><a href="#cb44-7"></a>}</span>
<span id="cb44-8"><a href="#cb44-8"></a></span>
<span id="cb44-9"><a href="#cb44-9"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb44-10"><a href="#cb44-10"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb44-11"><a href="#cb44-11"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb44-12"><a href="#cb44-12"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb44-13"><a href="#cb44-13"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb44-15"><a href="#cb44-15"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb44-16"><a href="#cb44-16"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb44-17"><a href="#cb44-17"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb44-18"><a href="#cb44-18"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb44-19"><a href="#cb44-19"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb44-20"><a href="#cb44-20"></a>      }</span>
<span id="cb44-21"><a href="#cb44-21"></a>  }</span>
<span id="cb44-22"><a href="#cb44-22"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb44-23"><a href="#cb44-23"></a>}</span>
<span id="cb44-24"><a href="#cb44-24"></a></span>
<span id="cb44-25"><a href="#cb44-25"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb44-26"><a href="#cb44-26"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb44-27"><a href="#cb44-27"></a>x0 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb44-28"><a href="#cb44-28"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb44-29"><a href="#cb44-29"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb44-30"><a href="#cb44-30"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb44-31"><a href="#cb44-31"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb44-32"><a href="#cb44-32"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span></code></pre></div>
<pre><code>## [1]   27  209 1434 4300</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>p1&lt;-rw1<span class="op">$</span>k<span class="op">/</span>N</span>
<span id="cb46-2"><a href="#cb46-2"></a>p2&lt;-rw2<span class="op">$</span>k<span class="op">/</span>N</span>
<span id="cb46-3"><a href="#cb46-3"></a>p3&lt;-rw3<span class="op">$</span>k<span class="op">/</span>N</span>
<span id="cb46-4"><a href="#cb46-4"></a>p4&lt;-rw4<span class="op">$</span>k<span class="op">/</span>N</span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="kw">print</span>(<span class="kw">c</span>(p1, p2, p3, p4))</span></code></pre></div>
<pre><code>## [1] 0.0054 0.0418 0.2868 0.8600</code></pre>
<p>From above, we find when we use different variances 0.01,0.1,1,10 for the proposal distribution, the number of candidate points rejected is 27,209,1434,4300. Only the third chain has a rejection rate in the range [0.15, 0.5].</p>
</div>
<div id="question-2-6" class="section level2">
<h2>2020-11-17 Question 2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb48-5"><a href="#cb48-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb48-6"><a href="#cb48-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb48-7"><a href="#cb48-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb48-8"><a href="#cb48-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb48-14"><a href="#cb48-14"></a>}</span>
<span id="cb48-15"><a href="#cb48-15"></a></span>
<span id="cb48-16"><a href="#cb48-16"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>    <span class="co"># four chains</span></span>
<span id="cb48-17"><a href="#cb48-17"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)    <span class="co"># overdispersed initial values</span></span>
<span id="cb48-18"><a href="#cb48-18"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span>    <span class="co"># length of chains</span></span>
<span id="cb48-19"><a href="#cb48-19"></a>b &lt;-<span class="st"> </span><span class="dv">200</span>    <span class="co"># burn-in length</span></span>
<span id="cb48-20"><a href="#cb48-20"></a></span>
<span id="cb48-21"><a href="#cb48-21"></a></span>
<span id="cb48-22"><a href="#cb48-22"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb48-23"><a href="#cb48-23"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb48-24"><a href="#cb48-24"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="fl">0.5</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb48-25"><a href="#cb48-25"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb48-26"><a href="#cb48-26"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb48-27"><a href="#cb48-27"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb48-28"><a href="#cb48-28"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb48-29"><a href="#cb48-29"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb48-30"><a href="#cb48-30"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb48-31"><a href="#cb48-31"></a><span class="kw">plot</span>(rhat[(<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb48-32"><a href="#cb48-32"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb49-3"><a href="#cb49-3"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">1</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb49-4"><a href="#cb49-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb49-6"><a href="#cb49-6"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb49-7"><a href="#cb49-7"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb49-9"><a href="#cb49-9"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb49-10"><a href="#cb49-10"></a>x2 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="kw">plot</span>(rhat[(<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb50-3"><a href="#cb50-3"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">4</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb50-4"><a href="#cb50-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb50-6"><a href="#cb50-6"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb50-7"><a href="#cb50-7"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb50-9"><a href="#cb50-9"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb50-10"><a href="#cb50-10"></a>x3 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb51-3"><a href="#cb51-3"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">16</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb51-4"><a href="#cb51-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb51-6"><a href="#cb51-6"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb51-7"><a href="#cb51-7"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb51-9"><a href="#cb51-9"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb51-10"><a href="#cb51-10"></a>x4 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span></code></pre></div>
<pre><code>## Warning in min(which(rhat &gt; 0 &amp; rhat &lt; 1.2)): min里所有的参数都不存在; 回覆Inf</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">c</span>(x2,x3,x4)</span></code></pre></div>
<pre><code>## [1] 1956  560  Inf</code></pre>
<p>From above,we run the chain until it converges approximately to the target distribution <span class="math inline">\(\hat R = 1.1141&lt;1.2\)</span></p>
</div>
<div id="question-3-4" class="section level2">
<h2>2020-11-17 Question 3</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt k)\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt {\frac{a^2(k-1)}{k-a^2}})\]</span> and<span class="math display">\[S_k(a)=P(t(k)&gt;\sqrt {\frac{a^2k}{k+1-a^2}})\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>k=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>Ak=<span class="kw">numeric</span>()</span>
<span id="cb56-4"><a href="#cb56-4"></a>N=<span class="kw">length</span>(k)</span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb56-6"><a href="#cb56-6"></a>  solution=<span class="kw">uniroot</span>(</span>
<span id="cb56-7"><a href="#cb56-7"></a>    <span class="cf">function</span>(a) {<span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i])<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k[i])</span>
<span id="cb56-8"><a href="#cb56-8"></a>    },</span>
<span id="cb56-9"><a href="#cb56-9"></a>    <span class="dt">lower =</span> <span class="fl">1e-5</span>,<span class="dt">upper =</span> <span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">1e-5</span>)</span>
<span id="cb56-10"><a href="#cb56-10"></a>  solution &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(solution)[<span class="dv">1</span>])</span>
<span id="cb56-11"><a href="#cb56-11"></a>  <span class="cf">if</span>(solution<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>solution<span class="op">&lt;</span><span class="kw">sqrt</span>(k[i])) Ak[i] &lt;-<span class="st"> </span>solution </span>
<span id="cb56-12"><a href="#cb56-12"></a>  <span class="cf">else</span> Ak[i] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb56-13"><a href="#cb56-13"></a>}</span>
<span id="cb56-14"><a href="#cb56-14"></a><span class="kw">matrix</span>(Ak,<span class="dt">ncol=</span><span class="dv">1</span>,<span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;k=&quot;</span>,k,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="st">&quot;A(k)&quot;</span>))</span></code></pre></div>
<pre><code>##             A(k)
## k=4     1.492103
## k=5     1.533549
## k=6     1.562768
## k=7     1.584421
## k=8     1.601182
## k=9     1.614523
## k=10    1.625387
## k=11    1.634409
## k=12    1.642025
## k=13    1.648540
## k=14    1.654177
## k=15    1.659098
## k=16    1.663451
## k=17    1.667288
## k=18    1.670736
## k=19    1.673841
## k=20    1.676588
## k=21    1.679139
## k=22    1.681461
## k=23    4.795822
## k=24    4.898969
## k=25    4.999990
## k=100   9.999990
## k=500  22.360670
## k=1000 31.622767</code></pre>
</div>
<div id="question-1-7" class="section level2">
<h2>2020-11-24 Question 1</h2>
<p>(1)Observed data: <span class="math inline">\(n_{A·} = n_{AA} + n_{AO} = 444\)</span>(A-type), <span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 132\)</span> (B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type), <span class="math inline">\(n_{AB} = 63\)</span> (AB-type)</p>
<p>(2)Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p>(3)Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>nA &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>nB &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>nOO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>nAB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>N&lt;-<span class="dv">1000</span></span>
<span id="cb58-7"><a href="#cb58-7"></a>func&lt;-<span class="cf">function</span>(p,q,n){</span>
<span id="cb58-8"><a href="#cb58-8"></a>  func&lt;-nA<span class="op">*</span>(<span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)))<span class="op">+</span>nB<span class="op">*</span>(<span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">+</span>nAB<span class="op">*</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q))</span>
<span id="cb58-9"><a href="#cb58-9"></a>  <span class="kw">return</span>(func)</span>
<span id="cb58-10"><a href="#cb58-10"></a>}</span>
<span id="cb58-11"><a href="#cb58-11"></a></span>
<span id="cb58-12"><a href="#cb58-12"></a>p&lt;-<span class="fl">0.3</span></span>
<span id="cb58-13"><a href="#cb58-13"></a>q&lt;-<span class="fl">0.1</span></span>
<span id="cb58-14"><a href="#cb58-14"></a>k&lt;-<span class="dv">100</span></span>
<span id="cb58-15"><a href="#cb58-15"></a><span class="cf">for</span> (step <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</span>
<span id="cb58-16"><a href="#cb58-16"></a>  nAA&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,nA,p<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p<span class="dv">-2</span><span class="op">*</span>q))</span>
<span id="cb58-17"><a href="#cb58-17"></a>  nBB&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,nB,q<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q<span class="dv">-2</span><span class="op">*</span>p))</span>
<span id="cb58-18"><a href="#cb58-18"></a>  p&lt;-(nA<span class="op">+</span>nAA<span class="op">+</span>nAB)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>N)</span>
<span id="cb58-19"><a href="#cb58-19"></a>  q&lt;-(nB<span class="op">+</span>nBB<span class="op">+</span>nAB)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>N)</span>
<span id="cb58-20"><a href="#cb58-20"></a>  <span class="kw">cat</span>(<span class="st">&quot;step&quot;</span>,step,<span class="st">&quot;p&quot;</span>,p,<span class="st">&quot;q&quot;</span>,q,<span class="st">&quot;func&quot;</span>,<span class="kw">func</span>(p,q,N),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb58-21"><a href="#cb58-21"></a>}</span></code></pre></div>
<pre><code>## step 1 p 0.299 q 0.1015 func -1169.841 
## step 2 p 0.301 q 0.106 func -1170.01 
## step 3 p 0.2975 q 0.1015 func -1169.838 
## step 4 p 0.295 q 0.1005 func -1169.918 
## step 5 p 0.3025 q 0.1025 func -1169.916 
## step 6 p 0.2915 q 0.102 func -1169.994 
## step 7 p 0.294 q 0.107 func -1170.029 
## step 8 p 0.2895 q 0.1005 func -1170.195 
## step 9 p 0.293 q 0.1055 func -1169.96 
## step 10 p 0.297 q 0.102 func -1169.83 
## step 11 p 0.2985 q 0.102 func -1169.828 
## step 12 p 0.3035 q 0.104 func -1169.999 
## step 13 p 0.304 q 0.104 func -1170.026 
## step 14 p 0.298 q 0.1025 func -1169.822 
## step 15 p 0.2875 q 0.1005 func -1170.36 
## step 16 p 0.304 q 0.1035 func -1170.007 
## step 17 p 0.2995 q 0.1025 func -1169.835 
## step 18 p 0.3005 q 0.1025 func -1169.854 
## step 19 p 0.301 q 0.102 func -1169.867 
## step 20 p 0.3015 q 0.103 func -1169.887 
## step 21 p 0.3035 q 0.101 func -1169.968 
## step 22 p 0.293 q 0.1025 func -1169.914 
## step 23 p 0.289 q 0.1015 func -1170.175 
## step 24 p 0.2975 q 0.1005 func -1169.875 
## step 25 p 0.2935 q 0.102 func -1169.905 
## step 26 p 0.2995 q 0.0995 func -1169.932 
## step 27 p 0.2905 q 0.104 func -1170.028 
## step 28 p 0.296 q 0.1025 func -1169.834 
## step 29 p 0.301 q 0.103 func -1169.871 
## step 30 p 0.296 q 0.1 func -1169.923 
## step 31 p 0.2995 q 0.103 func -1169.838 
## step 32 p 0.303 q 0.1035 func -1169.957 
## step 33 p 0.295 q 0.103 func -1169.849 
## step 34 p 0.2995 q 0.1015 func -1169.846 
## step 35 p 0.3005 q 0.103 func -1169.858 
## step 36 p 0.293 q 0.104 func -1169.913 
## step 37 p 0.2995 q 0.1045 func -1169.878 
## step 38 p 0.3035 q 0.103 func -1169.967 
## step 39 p 0.297 q 0.1015 func -1169.841 
## step 40 p 0.2865 q 0.1015 func -1170.39 
## step 41 p 0.2935 q 0.1025 func -1169.895 
## step 42 p 0.3025 q 0.1035 func -1169.935 
## step 43 p 0.3015 q 0.102 func -1169.881 
## step 44 p 0.3025 q 0.1025 func -1169.916 
## step 45 p 0.298 q 0.102 func -1169.827 
## step 46 p 0.2985 q 0.1035 func -1169.833 
## step 47 p 0.2945 q 0.1035 func -1169.863 
## step 48 p 0.3045 q 0.102 func -1170.007 
## step 49 p 0.2955 q 0.1035 func -1169.843 
## step 50 p 0.2925 q 0.1015 func -1169.963 
## step 51 p 0.295 q 0.1045 func -1169.872 
## step 52 p 0.3005 q 0.105 func -1169.928 
## step 53 p 0.301 q 0.1035 func -1169.881 
## step 54 p 0.305 q 0.1025 func -1170.039 
## step 55 p 0.299 q 0.101 func -1169.855 
## step 56 p 0.293 q 0.1025 func -1169.914 
## step 57 p 0.2945 q 0.104 func -1169.87 
## step 58 p 0.298 q 0.102 func -1169.827 
## step 59 p 0.291 q 0.102 func -1170.022 
## step 60 p 0.2945 q 0.1015 func -1169.888 
## step 61 p 0.293 q 0.105 func -1169.939 
## step 62 p 0.296 q 0.1025 func -1169.834 
## step 63 p 0.3025 q 0.103 func -1169.923 
## step 64 p 0.3055 q 0.101 func -1170.07 
## step 65 p 0.2995 q 0.104 func -1169.86 
## step 66 p 0.295 q 0.1005 func -1169.918 
## step 67 p 0.3015 q 0.1005 func -1169.913 
## step 68 p 0.302 q 0.101 func -1169.912 
## step 69 p 0.3015 q 0.104 func -1169.913 
## step 70 p 0.298 q 0.103 func -1169.823 
## step 71 p 0.3045 q 0.1015 func -1170.008 
## step 72 p 0.298 q 0.105 func -1169.88 
## step 73 p 0.2935 q 0.1045 func -1169.908 
## step 74 p 0.3015 q 0.1045 func -1169.935 
## step 75 p 0.298 q 0.103 func -1169.823 
## step 76 p 0.294 q 0.1015 func -1169.903 
## step 77 p 0.296 q 0.1025 func -1169.834 
## step 78 p 0.302 q 0.102 func -1169.897 
## step 79 p 0.295 q 0.101 func -1169.893 
## step 80 p 0.291 q 0.103 func -1170.001 
## step 81 p 0.303 q 0.1015 func -1169.938 
## step 82 p 0.2975 q 0.102 func -1169.827 
## step 83 p 0.2945 q 0.1005 func -1169.933 
## step 84 p 0.2995 q 0.104 func -1169.86 
## step 85 p 0.291 q 0.1025 func -1170.009 
## step 86 p 0.3045 q 0.103 func -1170.02 
## step 87 p 0.3045 q 0.102 func -1170.007 
## step 88 p 0.2995 q 0.1015 func -1169.846 
## step 89 p 0.296 q 0.0995 func -1169.958 
## step 90 p 0.298 q 0.101 func -1169.852 
## step 91 p 0.2885 q 0.1005 func -1170.273 
## step 92 p 0.2955 q 0.103 func -1169.84 
## step 93 p 0.293 q 0.104 func -1169.913 
## step 94 p 0.2905 q 0.102 func -1170.052 
## step 95 p 0.299 q 0.106 func -1169.955 
## step 96 p 0.3 q 0.1025 func -1169.844 
## step 97 p 0.297 q 0.102 func -1169.83 
## step 98 p 0.294 q 0.1005 func -1169.949 
## step 99 p 0.296 q 0.1015 func -1169.853 
## step 100 p 0.3025 q 0.1035 func -1169.935</code></pre>
<p>We find that compare corresponding log-maximum likelihood values (for observed data) with EM steps, corresponding log-maximum likelihood values are increasing.</p>
</div>
<div id="question-2-7" class="section level2">
<h2>2020-11-24 Question 2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb60-2"><a href="#cb60-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb60-3"><a href="#cb60-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb60-4"><a href="#cb60-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb60-5"><a href="#cb60-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb60-6"><a href="#cb60-6"></a>)</span>
<span id="cb60-7"><a href="#cb60-7"></a>f&lt;-<span class="kw">as.character</span>(formulas)</span>
<span id="cb60-8"><a href="#cb60-8"></a>out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(f))</span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</span>
<span id="cb60-10"><a href="#cb60-10"></a>out[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(f[[i]],mtcars)</span>
<span id="cb60-11"><a href="#cb60-11"></a>}</span>
<span id="cb60-12"><a href="#cb60-12"></a><span class="kw">print</span>(out)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>out1&lt;-<span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">print</span>(out1)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-5" class="section level2">
<h2>2020-11-24 Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>)</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="dv">100</span>,</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>)</span>
<span id="cb64-6"><a href="#cb64-6"></a>p &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]] )</span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>##   [1] 0.87247592 0.16297609 0.73007134 0.36957747 0.14539587 0.41050618
##   [7] 0.16052861 0.41126428 0.44450727 0.41174909 0.12335456 0.83011465
##  [13] 0.68911172 0.94104713 0.85054571 0.26823093 0.72736195 0.59284669
##  [19] 0.46868291 0.13935417 0.33233951 0.54124721 0.80693393 0.47487089
##  [25] 0.94198651 0.91706085 0.17295795 0.88275679 0.03643808 0.13554248
##  [31] 0.02800814 0.78345706 0.45889772 0.71630390 0.91445448 0.49885720
##  [37] 0.02875246 0.96033636 0.18230151 0.42099433 0.20526564 0.35343966
##  [43] 0.97701024 0.02797607 0.73466504 0.66510099 0.72315537 0.99473417
##  [49] 0.43363450 0.58181412 0.09993877 0.92803723 0.99324001 0.36735359
##  [55] 0.32340671 0.15392911 0.64759017 0.19018592 0.96503897 0.75216338
##  [61] 0.58812694 0.63595445 0.76329832 0.63182137 0.51015656 0.08057439
##  [67] 0.13396864 0.50661644 0.94795601 0.90510360 0.98205673 0.42823186
##  [73] 0.22851223 0.05494692 0.98507688 0.53354118 0.75364975 0.14897143
##  [79] 0.23815228 0.82297373 0.10426785 0.64464479 0.73058177 0.42606851
##  [85] 0.03343124 0.11979255 0.28975541 0.86055581 0.55562010 0.86031590
##  [91] 0.27961845 0.92031102 0.84427910 0.56643528 0.64458912 0.28380446
##  [97] 0.16848919 0.42821262 0.90793168 0.53316899</code></pre>
</div>
<div id="question-4-3" class="section level2">
<h2>2020-11-24 Question 4</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>mapvapply &lt;-<span class="st"> </span><span class="cf">function</span>(x,f,f_value){</span>
<span id="cb66-2"><a href="#cb66-2"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">Map</span>(f,x)</span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="kw">vapply</span>(x,g,f_value)</span>
<span id="cb66-4"><a href="#cb66-4"></a>}</span></code></pre></div>
<p>We need to know x, f and f_value.</p>
</div>
<div id="question-1-8" class="section level2">
<h2>2020-12-01 Question 1</h2>
<p>Write an Rcpp function for Exercise 9.4</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">library</span>(Rcpp) </span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rw_Metropolis(double sigma,double x0,int N) {</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="st">  NumericVector x(N);</span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="st">  x[0]=x0;</span></span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="st">  NumericVector u(N);</span></span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="st">  u=runif(N);</span></span>
<span id="cb67-7"><a href="#cb67-7"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb67-8"><a href="#cb67-8"></a><span class="st">    NumericVector y(1);</span></span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="st">    y=rnorm(1, x[i-1], sigma);</span></span>
<span id="cb67-10"><a href="#cb67-10"></a><span class="st">    if(u[i] &lt;= ((exp(-abs(y[0]))) / (exp(-abs(x[i-1]))))){</span></span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="st">      x[i] = y[0];</span></span>
<span id="cb67-12"><a href="#cb67-12"></a><span class="st">    }</span></span>
<span id="cb67-13"><a href="#cb67-13"></a><span class="st">    else{</span></span>
<span id="cb67-14"><a href="#cb67-14"></a><span class="st">      x[i] = x[i-1];</span></span>
<span id="cb67-15"><a href="#cb67-15"></a><span class="st">    }</span></span>
<span id="cb67-16"><a href="#cb67-16"></a><span class="st">  }</span></span>
<span id="cb67-17"><a href="#cb67-17"></a><span class="st">  return x;</span></span>
<span id="cb67-18"><a href="#cb67-18"></a><span class="st">}&#39;</span>)</span>
<span id="cb67-19"><a href="#cb67-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb67-20"><a href="#cb67-20"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb67-21"><a href="#cb67-21"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb67-22"><a href="#cb67-22"></a>rw1 =<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb67-23"><a href="#cb67-23"></a>rw2 =<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb67-24"><a href="#cb67-24"></a>rw3 =<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb67-25"><a href="#cb67-25"></a>rw4 =<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb67-26"><a href="#cb67-26"></a>rw =<span class="st"> </span><span class="kw">cbind</span>(rw1, rw2, rw3,  rw4)</span>
<span id="cb67-27"><a href="#cb67-27"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb67-28"><a href="#cb67-28"></a>  <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb67-29"><a href="#cb67-29"></a>       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb67-30"><a href="#cb67-30"></a>       <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb67-31"><a href="#cb67-31"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-8" class="section level2">
<h2>2020-12-01 Question 2</h2>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
<p>the qqplot of C++ function</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="kw">qqplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb68-3"><a href="#cb68-3"></a>       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb68-4"><a href="#cb68-4"></a>       <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb68-5"><a href="#cb68-5"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>the qqplot of R function</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">set.seed</span>(<span class="dv">3000</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a></span>
<span id="cb69-3"><a href="#cb69-3"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb69-4"><a href="#cb69-4"></a></span>
<span id="cb69-5"><a href="#cb69-5"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb69-6"><a href="#cb69-6"></a> x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb69-7"><a href="#cb69-7"></a> x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb69-8"><a href="#cb69-8"></a> u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb69-9"><a href="#cb69-9"></a> k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb69-10"><a href="#cb69-10"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb69-11"><a href="#cb69-11"></a>  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb69-12"><a href="#cb69-12"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb69-13"><a href="#cb69-13"></a>  <span class="cf">else</span> {</span>
<span id="cb69-14"><a href="#cb69-14"></a>  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb69-15"><a href="#cb69-15"></a>  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb69-16"><a href="#cb69-16"></a>  }</span>
<span id="cb69-17"><a href="#cb69-17"></a> }</span>
<span id="cb69-18"><a href="#cb69-18"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb69-19"><a href="#cb69-19"></a>}</span>
<span id="cb69-20"><a href="#cb69-20"></a></span>
<span id="cb69-21"><a href="#cb69-21"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb69-22"><a href="#cb69-22"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb69-23"><a href="#cb69-23"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb69-24"><a href="#cb69-24"></a>rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb69-25"><a href="#cb69-25"></a>rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb69-26"><a href="#cb69-26"></a>rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb69-27"><a href="#cb69-27"></a>rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb69-28"><a href="#cb69-28"></a>    rw =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb69-29"><a href="#cb69-29"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb69-30"><a href="#cb69-30"></a>        <span class="kw">qqplot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb69-31"><a href="#cb69-31"></a>             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb69-32"><a href="#cb69-32"></a>             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb69-33"><a href="#cb69-33"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///85SQBDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFsElEQVR4nO3c6XraRhhAYXkhTWvaJLbpYhqBuf+LLEiCAkI6MnxCg3XOj4Q8Hgb8RguLpGxlrWVDP4HUEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggKBspupqGAYqfrL4EggSCBGsv2/uw8PPjRk04gSCBIIEggSCBIIEggSCBIIEggSCBIIEggaBCgj3+SOVwuQZBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFCvQO8v5SfP928h0w1Sn0Dz7Km8kW9vXDTdMPUI9P6yY5k//Lx4uoHqEWg5fd7ezBtWsnEDuQRR86xahG54G5T1uhdbTsu9WMPycxNAB391Hh/88Ak3DNANfTfvEgQJBPUJtN1Et7zZGAPQX03vszYvhBrfhDVOl1rnAS2/b/+9mLQZvL88dnr4hDsTaHr3WtyYNb9RL8qz57Yff1qgzecYj5vFJ4MlpON0CXf2NijP7r5l1XJ08cMn3Pkb6XIhinn4hDsbaL5Zgmgn1X26ZDsTaP0S57H4s+Fd+genS7ie92IdHz7h+n0d1PXhE67XV9LnTJdavlmFBIIEggRqLxOotd1nwgKdau8zc4FqHX6lINBB9S9cBNp1+tuosQPhBQHHCPShyySODOjj3+qOA+iCL7w/EVDE9UZPzBo+sH2WyIMX4hTaHiR8YI/TXUXk+DHDB0ZON4TI8VMIH3jhdIOLHD+f8IFnT5eMyUGJAKVIU5YEUKo4m1IASpgnEaDYqWMbHijl9WuVAFDaPCkAxc4b3tBAqS9AwwPFThufQNDAQMmvYYMDxc7aQwJBPQF1PS18rECdTwsfKVD3k3pHCtT9tPCRArkEUZ1PCx8rUOfTwkcL1HU6gWA6gWA6gY5nOfpKcKRA3U8LHylQ99PCxwrU9bTw9D8O6m0bdPunhVcN/ZFr8gkE9Qm09541YrphGgzoZhoI6GOTdhw3yLAzh28SCBLo4gQKmlSgmHECpTjszOGxkwoUM+7zAX2mBIIEggSCBIIEggSCBIIEggSCBIIEggSC4oHyrO2y1OURIo/749rv0Nbil7foKWuFA+XrZ5Y3P7vFl9ejcXCHlpbT4mCTyCnrRQOVX3nMGg8C2R5gvRtHd2gur45SCpzyRNFAi8nm8I9543FE88ejcXSHxvLsqaSJm/JU4UDF8t50IP76//XrenvxtDeO7tBWea/QKWtFA5WrfuMGYDndHGI9e/p/HNyh/cE2BrFT1royUDXo/i0OKHbKWtdexcpBk+fAVSx0ylrX3kiXg768hmxR94GCpqx15d18+dzXv1jIPrkAip2y1rVfKBZPe71FDXlVV+3FIqesFf9WY97+Mn+23ic/H4yDO7RUrWKRU9byzSokECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQdEtA5VG/q8WkPOj3Ot0QUHXUb/7wc33zakK3A1Qd9Vse/BN0dFSHbgZoe9Tv7rDxK5UY0Pufk+L6UCcvwFMA5ff/TBt+3kuJAc0e/l4tvjdcjLkAmm9WNLyeY1xpAVXHp/5W/GNWXW1sZ1EC3QUewtqhtIDK33v5++nNTAlUnsAyab/gZVxJAk1P//bVNujgDJ/eSwuopKkWj9OrWDlkrKvYKr/7sd4CN1wyvzq5Z/1Tvs5cWIkBrf79I8t+bduLFa8Yx7ubTy+BIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIGg/wBqvlHMzWt71AAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="question-3-6" class="section level2">
<h2>2020-12-01 Question 3</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb70-2"><a href="#cb70-2"></a>sigma0 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="kw">rw_Metropolis</span>(sigma0, x0, N),</span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="kw">rw.Metropolis</span>(sigma0, x0, N)</span>
<span id="cb70-6"><a href="#cb70-6"></a>)</span>
<span id="cb70-7"><a href="#cb70-7"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                           expr     lq  median      uq
## 1 rw_Metropolis(sigma0, x0, N)  378.5  389.55  413.20
## 2 rw.Metropolis(sigma0, x0, N) 4699.5 4888.05 5348.65</code></pre>
</div>
<div id="question-4-4" class="section level2">
<h2>2020-12-01 Question 4</h2>
<p>Comments your results.</p>
<p>the results of C++ function and R function are the same, but C++ function is much faster.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
