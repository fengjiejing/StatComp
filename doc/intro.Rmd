---
title: "Introduction to StatComp20097"
author: "Feng Jiejing"
date: "2020-12-09"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to StatComp20097}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Overview

__StatComp20097__ is a simple R package which using dichotomy to find confidence intervals and the solution of gamma functions for the 'Statistical Computing' course. Two functions are considered, namely, 

_gammaCI_ solve the gamma function confidence interval by dichotomy, two confidence intervals are generated by setting two initial values of the left endpoint of the confidence interval. The the dichotomy method is used to solve the problem step by step until the minimum confidence interval is obtained

_gammasolution_ solve the solution of the gamma function, determining initial values by roughly estimating the range of the root of the function, if there are two solutions,they are distributed on the left and right sides of the highest point of the density function, So we use dichotomy on the both sides.


The source R code is as follows:
```{r}
gammaCI <- function(alpha,lambda,beta){
  a = 0
  if (qgamma(1-alpha,shape = lambda,scale = beta) > (lambda-1)/beta){
    b = (lambda-1)/beta
  }
  else{
    b = qgamma(1-alpha,shape = lambda,scale = beta)
  }
  for (i in 1:40) {
    c = (a+b)/2
    ap = pgamma(a,shape = lambda,scale = beta)
    aint = pgamma(a,shape = lambda,scale = beta)+alpha
    bp = pgamma(b,shape = lambda,scale = beta)
    bint = pgamma(b,shape = lambda,scale = beta)+alpha
    a_interval = qgamma(aint,shape = lambda,scale = beta)-qgamma(ap,shape = lambda,scale = beta)
    b_interval = qgamma(bint,shape = lambda,scale = beta)-qgamma(bp,shape = lambda,scale = beta)
    if (b_interval>a_interval)
      b = c
    else
      a = c
  }
  cat('when the confidence is',alpha,'confidence interval is','[',qgamma(ap,shape = lambda,scale = beta),',',qgamma(aint,shape = lambda,scale = beta),']')
}
```


```{r}
gammasolution <- function(value,lambda,beta,prec){
  leftx <- function(value,lambda,beta,prec){
    a=0
    b=(lambda-1)/beta
    ga=dgamma(a,shape = lambda,scale = beta)-value
    gb=dgamma(b,shape = lambda,scale = beta)-value
    while(b-a>prec){
      c=(a+b)/2
      gc=dgamma(c,shape = lambda,scale = beta)-value
      if (ga*gc < 0){
        b=c
        gb=gc
      }
      else{
        a=c
        ga=gc
      }
    }
    (a+b)/2
  }
  
  rightx <- function(value,lambda,beta,prec){
    a=20
    b=(lambda-1)/beta
    ga=dgamma(a,shape = lambda,scale = beta)-value
    gb=dgamma(b,shape = lambda,scale = beta)-value
    while(b-a>prec){
      c=(a+b)/2
      gc=dgamma(c,shape = lambda,scale = beta)-value
      if (ga*gc < 0){
        b=c
        gb=gc
      }
      else{
        a=c
        ga=gc
      }
    }
    (a+b)/2
  }
  left = leftx(value,lambda,beta,prec)
  right = rightx(value,lambda,beta,prec)
  cat('when the value of the function is',value,'the solution is',left,right)
}
```
